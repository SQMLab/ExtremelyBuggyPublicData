{
    "origin": "codeshovel",
    "repositoryName": "xerces2-j",
    "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/xerces2-j/.git",
    "startCommitName": "HEAD",
    "sourceFileName": "XMLSchemaValidator.java",
    "functionName": "addDefaultAttributes",
    "functionId": "addDefaultAttributes___element-QName__attributes-XMLAttributes__attrGrp-XSAttributeGroupDecl",
    "sourceFilePath": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
    "functionStartLine": 3186,
    "functionEndLine": 3265,
    "numCommitsSeen": 228,
    "timeTaken": 13007,
    "changeHistory": [
        "22c0e12e4b704d038f0b290865301ebf56f40455",
        "c6e91d6992e5101de286a0755a9105829515900a",
        "e8a80f3c5d0c6e2786e6e699b2aa47d125a9287a",
        "71823bb76fbbe51476f8c4f76984133133ae289e",
        "4e1e19ced55a817426c001c80c45a318b4be4e04",
        "3a5616841fafc6baf1fc02bf61b3afb56f07ca64",
        "8956d0e37f3362fce53d0baf75ae0bfdc7a30ae4",
        "f17905e8fb81376d5e118eed13fcab5b2897f20f",
        "b5ab952f0411ccb1f7319bf2723adf5d25ec0931",
        "8e28a50b92027b6ebafa72dee1b16d988774b14d",
        "796400a575745062c61f687a1a33aca5dac3be37",
        "75e2e681bdd7bc3fd19ab1e3fdda21e09b4ec1ae",
        "6d16ad6967b361d2162b6662305bba9bea7c8ae2",
        "0ca00513ef69c712b32f780d6112f4df373a44f6",
        "20cecb8fa7fe6bc9ad20c645d42075c5f9fef1b6",
        "666a9ddc196896bef002996fbbf5112b56ecdcf1",
        "692f02297ca0a43ca4ae4c568af141d25bac5210",
        "e51ce2c0e73e2d37d4808f387256722869dad19d",
        "b25b4597a4c172b405d835abd17a635c716428b5",
        "ecb3a007d50064a77832d083a13726949b000a20",
        "7392bd92a4fbb068fb68a41a3d0b1412cdedfbf3",
        "0bda873da1f953991e2e851625ade33725fdcb47",
        "ee02ba85bc60660c5eafb3f526ea75307b0b8132",
        "3452001fbd3f2a3d45004aeed7bc76f7b039a1cc",
        "f2c3d5aeff56c12720428209f58bb1c922a4de8b",
        "3701f6a121634ea976ed4dd2d4e816b59062e9ee"
    ],
    "changeHistoryShort": {
        "3701f6a121634ea976ed4dd2d4e816b59062e9ee": "Ybodychange",
        "f2c3d5aeff56c12720428209f58bb1c922a4de8b": "Ybodychange",
        "3452001fbd3f2a3d45004aeed7bc76f7b039a1cc": "Ybodychange",
        "ee02ba85bc60660c5eafb3f526ea75307b0b8132": "Ybodychange",
        "0bda873da1f953991e2e851625ade33725fdcb47": "Ybodychange",
        "7392bd92a4fbb068fb68a41a3d0b1412cdedfbf3": "Ybodychange",
        "ecb3a007d50064a77832d083a13726949b000a20": "Ybodychange",
        "b25b4597a4c172b405d835abd17a635c716428b5": "Ybodychange",
        "e51ce2c0e73e2d37d4808f387256722869dad19d": "Ybodychange",
        "692f02297ca0a43ca4ae4c568af141d25bac5210": "Ybodychange",
        "666a9ddc196896bef002996fbbf5112b56ecdcf1": "Ybodychange",
        "20cecb8fa7fe6bc9ad20c645d42075c5f9fef1b6": "Ybodychange",
        "0ca00513ef69c712b32f780d6112f4df373a44f6": "Ybodychange",
        "6d16ad6967b361d2162b6662305bba9bea7c8ae2": "Ybodychange",
        "75e2e681bdd7bc3fd19ab1e3fdda21e09b4ec1ae": "Ybodychange",
        "796400a575745062c61f687a1a33aca5dac3be37": "Ybodychange",
        "8e28a50b92027b6ebafa72dee1b16d988774b14d": "Ybodychange",
        "b5ab952f0411ccb1f7319bf2723adf5d25ec0931": "Ybodychange",
        "f17905e8fb81376d5e118eed13fcab5b2897f20f": "Ybodychange",
        "8956d0e37f3362fce53d0baf75ae0bfdc7a30ae4": "Ybodychange",
        "3a5616841fafc6baf1fc02bf61b3afb56f07ca64": "Ybodychange",
        "4e1e19ced55a817426c001c80c45a318b4be4e04": "Ybodychange",
        "71823bb76fbbe51476f8c4f76984133133ae289e": "Ybodychange",
        "e8a80f3c5d0c6e2786e6e699b2aa47d125a9287a": "Ybodychange",
        "c6e91d6992e5101de286a0755a9105829515900a": "Ybodychange",
        "22c0e12e4b704d038f0b290865301ebf56f40455": "Yintroduced"
    },
    "changeHistoryDetails": {
        "3701f6a121634ea976ed4dd2d4e816b59062e9ee": {
            "type": "Ybodychange",
            "commitMessage": "For Jira issue https://issues.apache.org/jira/browse/XERCESJ-1469. Update XSModel interfaces to a) expose an interface for values, and b) expose Identity Constraint definitions as top-level components.\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@1024038 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "18/10/10 3:06 PM",
            "commitName": "3701f6a121634ea976ed4dd2d4e816b59062e9ee",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "04/08/10 9:41 PM",
            "commitNameOld": "d0bd9aeef12d2aad43857f00d7b74c086814c594",
            "commitAuthorOld": "Michael Glavassevich",
            "daysBetweenCommits": 74.73,
            "commitsBetweenForRepo": 7,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,84 +1,80 @@\n     void addDefaultAttributes(\n         QName element,\n         XMLAttributes attributes,\n         XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl) attrUses.item(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\n                         \"cvc-complex-type.4\",\n                         new Object[] { element.rawname, currDecl.fName });\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName =\n                     new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n                 int attrIndex;\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n                     attrIndex = attrs.getLength();\n                     attrs.addAttributeNS(attName, \"CDATA\", normalized);\n                 }\n                 else {\n                     attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 }\n \n                 if (fAugPSVI) {\n \n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n-                    attrPSVI.fMemberType = defaultValue.memberType;\n-                    attrPSVI.fNormalizedValue = normalized;\n-                    attrPSVI.fActualValue = defaultValue.actualValue;\n-                    attrPSVI.fActualValueType = defaultValue.actualValueType;\n-                    attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n+                    attrPSVI.fValue.copyFrom(defaultValue);\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(\n        QName element,\n        XMLAttributes attributes,\n        XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl) attrUses.item(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\n                        \"cvc-complex-type.4\",\n                        new Object[] { element.rawname, currDecl.fName });\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName =\n                    new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n                int attrIndex;\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n                    attrIndex = attrs.getLength();\n                    attrs.addAttributeNS(attName, \"CDATA\", normalized);\n                }\n                else {\n                    attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                }\n\n                if (fAugPSVI) {\n\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fValue.copyFrom(defaultValue);\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {}
        },
        "f2c3d5aeff56c12720428209f58bb1c922a4de8b": {
            "type": "Ybodychange",
            "commitMessage": "Eliminating code in XMLAttributeImpl for storing whether an attribute has a schema ID type. Should save a bit of memory and also time in the schema validator. Nothing ever used this mechanism. The schema IDness of an attribute is retrieved from the PSVI.\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@937816 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "25/04/10 9:22 AM",
            "commitName": "f2c3d5aeff56c12720428209f58bb1c922a4de8b",
            "commitAuthor": "Michael Glavassevich",
            "commitDateOld": "22/02/10 1:02 PM",
            "commitNameOld": "17e968bd12be5ca225ace35b7e092726b91e0890",
            "commitAuthorOld": "Michael Glavassevich",
            "daysBetweenCommits": 61.81,
            "commitsBetweenForRepo": 16,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,90 +1,84 @@\n     void addDefaultAttributes(\n         QName element,\n         XMLAttributes attributes,\n         XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl) attrUses.item(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\n                         \"cvc-complex-type.4\",\n                         new Object[] { element.rawname, currDecl.fName });\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName =\n                     new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n                 int attrIndex;\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n                     attrIndex = attrs.getLength();\n                     attrs.addAttributeNS(attName, \"CDATA\", normalized);\n-                    boolean schemaId =\n-                        defaultValue != null\n-                            && defaultValue.memberType != null\n-                                ? defaultValue.memberType.isIDType()\n-                                : currDecl.fType.isIDType();\n-                    attrs.setSchemaId(attrIndex, schemaId);\n                 }\n                 else {\n                     attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 }\n \n                 if (fAugPSVI) {\n \n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n                     attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n                     attrPSVI.fActualValue = defaultValue.actualValue;\n                     attrPSVI.fActualValueType = defaultValue.actualValueType;\n                     attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(\n        QName element,\n        XMLAttributes attributes,\n        XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl) attrUses.item(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\n                        \"cvc-complex-type.4\",\n                        new Object[] { element.rawname, currDecl.fName });\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName =\n                    new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n                int attrIndex;\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n                    attrIndex = attrs.getLength();\n                    attrs.addAttributeNS(attName, \"CDATA\", normalized);\n                }\n                else {\n                    attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                }\n\n                if (fAugPSVI) {\n\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fActualValue = defaultValue.actualValue;\n                    attrPSVI.fActualValueType = defaultValue.actualValueType;\n                    attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {}
        },
        "3452001fbd3f2a3d45004aeed7bc76f7b039a1cc": {
            "type": "Ybodychange",
            "commitMessage": "Fixing a bug in the processing of default attributes. If two or more defaulted attributes\nhave the same local name it was possible for them to overwrite each other.\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@418433 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "30/06/06 8:52 PM",
            "commitName": "3452001fbd3f2a3d45004aeed7bc76f7b039a1cc",
            "commitAuthor": "Michael Glavassevich",
            "commitDateOld": "11/04/06 2:32 PM",
            "commitNameOld": "84925f43c06cd9d66671c6f8b6fb5619c2810e61",
            "commitAuthorOld": "Peter McCracken",
            "daysBetweenCommits": 80.26,
            "commitsBetweenForRepo": 31,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,85 +1,90 @@\n     void addDefaultAttributes(\n         QName element,\n         XMLAttributes attributes,\n         XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl) attrUses.item(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\n                         \"cvc-complex-type.4\",\n                         new Object[] { element.rawname, currDecl.fName });\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName =\n                     new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n-                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n+                int attrIndex;\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n+                    attrIndex = attrs.getLength();\n+                    attrs.addAttributeNS(attName, \"CDATA\", normalized);\n                     boolean schemaId =\n                         defaultValue != null\n                             && defaultValue.memberType != null\n                                 ? defaultValue.memberType.isIDType()\n                                 : currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n+                else {\n+                    attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n+                }\n \n                 if (fAugPSVI) {\n \n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n                     attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n                     attrPSVI.fActualValue = defaultValue.actualValue;\n                     attrPSVI.fActualValueType = defaultValue.actualValueType;\n                     attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(\n        QName element,\n        XMLAttributes attributes,\n        XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl) attrUses.item(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\n                        \"cvc-complex-type.4\",\n                        new Object[] { element.rawname, currDecl.fName });\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName =\n                    new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n                int attrIndex;\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n                    attrIndex = attrs.getLength();\n                    attrs.addAttributeNS(attName, \"CDATA\", normalized);\n                    boolean schemaId =\n                        defaultValue != null\n                            && defaultValue.memberType != null\n                                ? defaultValue.memberType.isIDType()\n                                : currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n                else {\n                    attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                }\n\n                if (fAugPSVI) {\n\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fActualValue = defaultValue.actualValue;\n                    attrPSVI.fActualValueType = defaultValue.actualValueType;\n                    attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "1",
            "TangledWMoveandFileRename": "1"
        },
        "ee02ba85bc60660c5eafb3f526ea75307b0b8132": {
            "type": "Ybodychange",
            "commitMessage": "PSVI API changes. Step 2:\n- Updated some doucmentation\n- Added interfaces for loading XSModels\n- Added methods to expose actual values and their types\n- Implementation of the new methods\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@319493 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "12/11/03 3:17 PM",
            "commitName": "ee02ba85bc60660c5eafb3f526ea75307b0b8132",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "11/11/03 12:15 PM",
            "commitNameOld": "060d846ff49287186d86711ec83dd1e136cd66fa",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 1.13,
            "commitsBetweenForRepo": 2,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,83 +1,85 @@\n \tvoid addDefaultAttributes(\n \t\tQName element,\n \t\tXMLAttributes attributes,\n \t\tXSAttributeGroupDecl attrGrp) {\n \t\t// Check after all specified attrs are scanned\n \t\t// (1) report error for REQUIRED attrs that are missing (V_TAGc)\n \t\t// REVISIT: should we check prohibited attributes?\n \t\t// (2) report error for PROHIBITED attrs that are present (V_TAGc)\n \t\t// (3) add default attrs (FIXED and NOT_FIXED)\n \t\t//\n \t\tif (DEBUG) {\n \t\t\tSystem.out.println(\"==>addDefaultAttributes: \" + element);\n \t\t}\n \t\tXSObjectList attrUses = attrGrp.getAttributeUses();\n \t\tint useCount = attrUses.getLength();\n \t\tXSAttributeUseImpl currUse;\n \t\tXSAttributeDecl currDecl;\n \t\tshort constType;\n \t\tValidatedInfo defaultValue;\n \t\tboolean isSpecified;\n \t\tQName attName;\n \t\t// for each attribute use\n \t\tfor (int i = 0; i < useCount; i++) {\n \n \t\t\tcurrUse = (XSAttributeUseImpl) attrUses.item(i);\n \t\t\tcurrDecl = currUse.fAttrDecl;\n \t\t\t// get value constraint\n \t\t\tconstType = currUse.fConstraintType;\n \t\t\tdefaultValue = currUse.fDefault;\n \t\t\tif (constType == XSConstants.VC_NONE) {\n \t\t\t\tconstType = currDecl.getConstraintType();\n \t\t\t\tdefaultValue = currDecl.fDefault;\n \t\t\t}\n \t\t\t// whether this attribute is specified\n \t\t\tisSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n \t\t\t// Element Locally Valid (Complex Type)\n \t\t\t// 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n \t\t\t// {required} is true matches one of the attribute information items in the element\n \t\t\t// information item's [attributes] as per clause 3.1 above.\n \t\t\tif (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n \t\t\t\tif (!isSpecified)\n \t\t\t\t\treportSchemaError(\n \t\t\t\t\t\t\"cvc-complex-type.4\",\n \t\t\t\t\t\tnew Object[] { element.rawname, currDecl.fName });\n \t\t\t}\n \t\t\t// if the attribute is not specified, then apply the value constraint\n \t\t\tif (!isSpecified && constType != XSConstants.VC_NONE) {\n \t\t\t\tattName =\n \t\t\t\t\tnew QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \t\t\t\tString normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n \t\t\t\tint attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n \t\t\t\tif (attributes instanceof XMLAttributesImpl) {\n \t\t\t\t\tXMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n \t\t\t\t\tboolean schemaId =\n \t\t\t\t\t\tdefaultValue != null\n \t\t\t\t\t\t\t&& defaultValue.memberType != null\n \t\t\t\t\t\t\t\t? defaultValue.memberType.isIDType()\n \t\t\t\t\t\t\t\t: currDecl.fType.isIDType();\n \t\t\t\t\tattrs.setSchemaId(attrIndex, schemaId);\n \t\t\t\t}\n \n \t\t\t\tif (fAugPSVI) {\n \n \t\t\t\t\t// PSVI: attribute is \"schema\" specified\n \t\t\t\t\tAugmentations augs = attributes.getAugmentations(attrIndex);\n \t\t\t\t\tAttributePSVImpl attrPSVI = new AttributePSVImpl();\n \t\t\t\t\taugs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n \t\t\t\t\tattrPSVI.fDeclaration = currDecl;\n \t\t\t\t\tattrPSVI.fTypeDecl = currDecl.fType;\n \t\t\t\t\tattrPSVI.fMemberType = defaultValue.memberType;\n \t\t\t\t\tattrPSVI.fNormalizedValue = normalized;\n \t\t\t\t\tattrPSVI.fActualValue = defaultValue.actualValue;\n+                    attrPSVI.fActualValueType = defaultValue.actualValueType;\n+                    attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n \t\t\t\t\tattrPSVI.fValidationContext = fValidationRoot;\n \t\t\t\t\tattrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n \t\t\t\t\tattrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n \t\t\t\t\tattrPSVI.fSpecified = true;\n \t\t\t\t}\n \t\t\t}\n \n \t\t} // for\n \t} // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "\tvoid addDefaultAttributes(\n\t\tQName element,\n\t\tXMLAttributes attributes,\n\t\tXSAttributeGroupDecl attrGrp) {\n\t\t// Check after all specified attrs are scanned\n\t\t// (1) report error for REQUIRED attrs that are missing (V_TAGc)\n\t\t// REVISIT: should we check prohibited attributes?\n\t\t// (2) report error for PROHIBITED attrs that are present (V_TAGc)\n\t\t// (3) add default attrs (FIXED and NOT_FIXED)\n\t\t//\n\t\tif (DEBUG) {\n\t\t\tSystem.out.println(\"==>addDefaultAttributes: \" + element);\n\t\t}\n\t\tXSObjectList attrUses = attrGrp.getAttributeUses();\n\t\tint useCount = attrUses.getLength();\n\t\tXSAttributeUseImpl currUse;\n\t\tXSAttributeDecl currDecl;\n\t\tshort constType;\n\t\tValidatedInfo defaultValue;\n\t\tboolean isSpecified;\n\t\tQName attName;\n\t\t// for each attribute use\n\t\tfor (int i = 0; i < useCount; i++) {\n\n\t\t\tcurrUse = (XSAttributeUseImpl) attrUses.item(i);\n\t\t\tcurrDecl = currUse.fAttrDecl;\n\t\t\t// get value constraint\n\t\t\tconstType = currUse.fConstraintType;\n\t\t\tdefaultValue = currUse.fDefault;\n\t\t\tif (constType == XSConstants.VC_NONE) {\n\t\t\t\tconstType = currDecl.getConstraintType();\n\t\t\t\tdefaultValue = currDecl.fDefault;\n\t\t\t}\n\t\t\t// whether this attribute is specified\n\t\t\tisSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n\t\t\t// Element Locally Valid (Complex Type)\n\t\t\t// 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n\t\t\t// {required} is true matches one of the attribute information items in the element\n\t\t\t// information item's [attributes] as per clause 3.1 above.\n\t\t\tif (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n\t\t\t\tif (!isSpecified)\n\t\t\t\t\treportSchemaError(\n\t\t\t\t\t\t\"cvc-complex-type.4\",\n\t\t\t\t\t\tnew Object[] { element.rawname, currDecl.fName });\n\t\t\t}\n\t\t\t// if the attribute is not specified, then apply the value constraint\n\t\t\tif (!isSpecified && constType != XSConstants.VC_NONE) {\n\t\t\t\tattName =\n\t\t\t\t\tnew QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\t\t\t\tString normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n\t\t\t\tint attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n\t\t\t\tif (attributes instanceof XMLAttributesImpl) {\n\t\t\t\t\tXMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n\t\t\t\t\tboolean schemaId =\n\t\t\t\t\t\tdefaultValue != null\n\t\t\t\t\t\t\t&& defaultValue.memberType != null\n\t\t\t\t\t\t\t\t? defaultValue.memberType.isIDType()\n\t\t\t\t\t\t\t\t: currDecl.fType.isIDType();\n\t\t\t\t\tattrs.setSchemaId(attrIndex, schemaId);\n\t\t\t\t}\n\n\t\t\t\tif (fAugPSVI) {\n\n\t\t\t\t\t// PSVI: attribute is \"schema\" specified\n\t\t\t\t\tAugmentations augs = attributes.getAugmentations(attrIndex);\n\t\t\t\t\tAttributePSVImpl attrPSVI = new AttributePSVImpl();\n\t\t\t\t\taugs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n\t\t\t\t\tattrPSVI.fDeclaration = currDecl;\n\t\t\t\t\tattrPSVI.fTypeDecl = currDecl.fType;\n\t\t\t\t\tattrPSVI.fMemberType = defaultValue.memberType;\n\t\t\t\t\tattrPSVI.fNormalizedValue = normalized;\n\t\t\t\t\tattrPSVI.fActualValue = defaultValue.actualValue;\n                    attrPSVI.fActualValueType = defaultValue.actualValueType;\n                    attrPSVI.fItemValueTypes = defaultValue.itemValueTypes;\n\t\t\t\t\tattrPSVI.fValidationContext = fValidationRoot;\n\t\t\t\t\tattrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n\t\t\t\t\tattrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n\t\t\t\t\tattrPSVI.fSpecified = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} // for\n\t} // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "41"
        },
        "0bda873da1f953991e2e851625ade33725fdcb47": {
            "type": "Ybodychange",
            "commitMessage": "Reorganization of Identity constraint code that improves performance of schema validation.\nSome initial testing showed that for smaller documents (2K) with IDC support schema validation improves by 7%, for larger documents (10K) - up to 30%.\nMain changes are\n* removing reduntant data passed in the interfaces between XMLSchemaValidator and IDC support\n* changing data structures for IDC in XMLSchemaValidator: removing OrderedHashtable\n* storing actual values in the IDC code, previously the values were recomputed.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@319397 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "25/09/03 3:59 PM",
            "commitName": "0bda873da1f953991e2e851625ade33725fdcb47",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "25/07/03 11:34 AM",
            "commitNameOld": "e7911237f54ef3a9b96d3d31235ae646aa79f1a1",
            "commitAuthorOld": "Elena Litani",
            "daysBetweenCommits": 62.18,
            "commitsBetweenForRepo": 55,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,76 +1,83 @@\n-    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n-        // Check after all specified attrs are scanned\n-        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n-        // REVISIT: should we check prohibited attributes?\n-        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n-        // (3) add default attrs (FIXED and NOT_FIXED)\n-        //\n-        if (DEBUG) {\n-            System.out.println(\"==>addDefaultAttributes: \" + element);\n-        }\n-        XSObjectList attrUses = attrGrp.getAttributeUses();\n-        int useCount = attrUses.getLength();\n-        XSAttributeUseImpl currUse;\n-        XSAttributeDecl currDecl;\n-        short constType;\n-        ValidatedInfo defaultValue;\n-        boolean isSpecified;\n-        QName attName;\n-        // for each attribute use\n-        for (int i = 0; i < useCount; i++) {\n+\tvoid addDefaultAttributes(\n+\t\tQName element,\n+\t\tXMLAttributes attributes,\n+\t\tXSAttributeGroupDecl attrGrp) {\n+\t\t// Check after all specified attrs are scanned\n+\t\t// (1) report error for REQUIRED attrs that are missing (V_TAGc)\n+\t\t// REVISIT: should we check prohibited attributes?\n+\t\t// (2) report error for PROHIBITED attrs that are present (V_TAGc)\n+\t\t// (3) add default attrs (FIXED and NOT_FIXED)\n+\t\t//\n+\t\tif (DEBUG) {\n+\t\t\tSystem.out.println(\"==>addDefaultAttributes: \" + element);\n+\t\t}\n+\t\tXSObjectList attrUses = attrGrp.getAttributeUses();\n+\t\tint useCount = attrUses.getLength();\n+\t\tXSAttributeUseImpl currUse;\n+\t\tXSAttributeDecl currDecl;\n+\t\tshort constType;\n+\t\tValidatedInfo defaultValue;\n+\t\tboolean isSpecified;\n+\t\tQName attName;\n+\t\t// for each attribute use\n+\t\tfor (int i = 0; i < useCount; i++) {\n \n-            currUse = (XSAttributeUseImpl)attrUses.item(i);\n-            currDecl = currUse.fAttrDecl;\n-            // get value constraint\n-            constType = currUse.fConstraintType;\n-            defaultValue = currUse.fDefault;\n-            if (constType == XSConstants.VC_NONE) {\n-                constType = currDecl.getConstraintType();\n-                defaultValue = currDecl.fDefault;\n-            }\n-            // whether this attribute is specified\n-            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n+\t\t\tcurrUse = (XSAttributeUseImpl) attrUses.item(i);\n+\t\t\tcurrDecl = currUse.fAttrDecl;\n+\t\t\t// get value constraint\n+\t\t\tconstType = currUse.fConstraintType;\n+\t\t\tdefaultValue = currUse.fDefault;\n+\t\t\tif (constType == XSConstants.VC_NONE) {\n+\t\t\t\tconstType = currDecl.getConstraintType();\n+\t\t\t\tdefaultValue = currDecl.fDefault;\n+\t\t\t}\n+\t\t\t// whether this attribute is specified\n+\t\t\tisSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n-            // Element Locally Valid (Complex Type)\n-            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n-            // {required} is true matches one of the attribute information items in the element\n-            // information item's [attributes] as per clause 3.1 above.\n-            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n-                if (!isSpecified)\n-                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n-            }\n-            // if the attribute is not specified, then apply the value constraint\n-            if (!isSpecified && constType != XSConstants.VC_NONE) {\n-                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-                String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n-                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n-                if (attributes instanceof XMLAttributesImpl) {\n-                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n-                    boolean schemaId = defaultValue != null &&\n-                                       defaultValue.memberType != null ?\n-                                       defaultValue.memberType.isIDType() :\n-                                       currDecl.fType.isIDType();\n-                    attrs.setSchemaId(attrIndex, schemaId);\n-                }\n+\t\t\t// Element Locally Valid (Complex Type)\n+\t\t\t// 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n+\t\t\t// {required} is true matches one of the attribute information items in the element\n+\t\t\t// information item's [attributes] as per clause 3.1 above.\n+\t\t\tif (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n+\t\t\t\tif (!isSpecified)\n+\t\t\t\t\treportSchemaError(\n+\t\t\t\t\t\t\"cvc-complex-type.4\",\n+\t\t\t\t\t\tnew Object[] { element.rawname, currDecl.fName });\n+\t\t\t}\n+\t\t\t// if the attribute is not specified, then apply the value constraint\n+\t\t\tif (!isSpecified && constType != XSConstants.VC_NONE) {\n+\t\t\t\tattName =\n+\t\t\t\t\tnew QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n+\t\t\t\tString normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n+\t\t\t\tint attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n+\t\t\t\tif (attributes instanceof XMLAttributesImpl) {\n+\t\t\t\t\tXMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n+\t\t\t\t\tboolean schemaId =\n+\t\t\t\t\t\tdefaultValue != null\n+\t\t\t\t\t\t\t&& defaultValue.memberType != null\n+\t\t\t\t\t\t\t\t? defaultValue.memberType.isIDType()\n+\t\t\t\t\t\t\t\t: currDecl.fType.isIDType();\n+\t\t\t\t\tattrs.setSchemaId(attrIndex, schemaId);\n+\t\t\t\t}\n \n+\t\t\t\tif (fAugPSVI) {\n \n-                if (fAugPSVI) {\n+\t\t\t\t\t// PSVI: attribute is \"schema\" specified\n+\t\t\t\t\tAugmentations augs = attributes.getAugmentations(attrIndex);\n+\t\t\t\t\tAttributePSVImpl attrPSVI = new AttributePSVImpl();\n+\t\t\t\t\taugs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n-                    // PSVI: attribute is \"schema\" specified\n-                    Augmentations augs = attributes.getAugmentations(attrIndex);\n-                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n-                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n+\t\t\t\t\tattrPSVI.fDeclaration = currDecl;\n+\t\t\t\t\tattrPSVI.fTypeDecl = currDecl.fType;\n+\t\t\t\t\tattrPSVI.fMemberType = defaultValue.memberType;\n+\t\t\t\t\tattrPSVI.fNormalizedValue = normalized;\n+\t\t\t\t\tattrPSVI.fActualValue = defaultValue.actualValue;\n+\t\t\t\t\tattrPSVI.fValidationContext = fValidationRoot;\n+\t\t\t\t\tattrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n+\t\t\t\t\tattrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n+\t\t\t\t\tattrPSVI.fSpecified = true;\n+\t\t\t\t}\n+\t\t\t}\n \n-                    attrPSVI.fDeclaration = currDecl;\n-                    attrPSVI.fTypeDecl = currDecl.fType;\n-                    attrPSVI.fMemberType = defaultValue.memberType;\n-                    attrPSVI.fNormalizedValue = normalized;\n-                    attrPSVI.fValidationContext = fValidationRoot;\n-                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n-                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n-                    attrPSVI.fSpecified = true;\n-                }\n-            }\n-\n-        } // for\n-    } // addDefaultAttributes\n\\ No newline at end of file\n+\t\t} // for\n+\t} // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "\tvoid addDefaultAttributes(\n\t\tQName element,\n\t\tXMLAttributes attributes,\n\t\tXSAttributeGroupDecl attrGrp) {\n\t\t// Check after all specified attrs are scanned\n\t\t// (1) report error for REQUIRED attrs that are missing (V_TAGc)\n\t\t// REVISIT: should we check prohibited attributes?\n\t\t// (2) report error for PROHIBITED attrs that are present (V_TAGc)\n\t\t// (3) add default attrs (FIXED and NOT_FIXED)\n\t\t//\n\t\tif (DEBUG) {\n\t\t\tSystem.out.println(\"==>addDefaultAttributes: \" + element);\n\t\t}\n\t\tXSObjectList attrUses = attrGrp.getAttributeUses();\n\t\tint useCount = attrUses.getLength();\n\t\tXSAttributeUseImpl currUse;\n\t\tXSAttributeDecl currDecl;\n\t\tshort constType;\n\t\tValidatedInfo defaultValue;\n\t\tboolean isSpecified;\n\t\tQName attName;\n\t\t// for each attribute use\n\t\tfor (int i = 0; i < useCount; i++) {\n\n\t\t\tcurrUse = (XSAttributeUseImpl) attrUses.item(i);\n\t\t\tcurrDecl = currUse.fAttrDecl;\n\t\t\t// get value constraint\n\t\t\tconstType = currUse.fConstraintType;\n\t\t\tdefaultValue = currUse.fDefault;\n\t\t\tif (constType == XSConstants.VC_NONE) {\n\t\t\t\tconstType = currDecl.getConstraintType();\n\t\t\t\tdefaultValue = currDecl.fDefault;\n\t\t\t}\n\t\t\t// whether this attribute is specified\n\t\t\tisSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n\t\t\t// Element Locally Valid (Complex Type)\n\t\t\t// 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n\t\t\t// {required} is true matches one of the attribute information items in the element\n\t\t\t// information item's [attributes] as per clause 3.1 above.\n\t\t\tif (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n\t\t\t\tif (!isSpecified)\n\t\t\t\t\treportSchemaError(\n\t\t\t\t\t\t\"cvc-complex-type.4\",\n\t\t\t\t\t\tnew Object[] { element.rawname, currDecl.fName });\n\t\t\t}\n\t\t\t// if the attribute is not specified, then apply the value constraint\n\t\t\tif (!isSpecified && constType != XSConstants.VC_NONE) {\n\t\t\t\tattName =\n\t\t\t\t\tnew QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\t\t\t\tString normalized = (defaultValue != null) ? defaultValue.stringValue() : \"\";\n\t\t\t\tint attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n\t\t\t\tif (attributes instanceof XMLAttributesImpl) {\n\t\t\t\t\tXMLAttributesImpl attrs = (XMLAttributesImpl) attributes;\n\t\t\t\t\tboolean schemaId =\n\t\t\t\t\t\tdefaultValue != null\n\t\t\t\t\t\t\t&& defaultValue.memberType != null\n\t\t\t\t\t\t\t\t? defaultValue.memberType.isIDType()\n\t\t\t\t\t\t\t\t: currDecl.fType.isIDType();\n\t\t\t\t\tattrs.setSchemaId(attrIndex, schemaId);\n\t\t\t\t}\n\n\t\t\t\tif (fAugPSVI) {\n\n\t\t\t\t\t// PSVI: attribute is \"schema\" specified\n\t\t\t\t\tAugmentations augs = attributes.getAugmentations(attrIndex);\n\t\t\t\t\tAttributePSVImpl attrPSVI = new AttributePSVImpl();\n\t\t\t\t\taugs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n\t\t\t\t\tattrPSVI.fDeclaration = currDecl;\n\t\t\t\t\tattrPSVI.fTypeDecl = currDecl.fType;\n\t\t\t\t\tattrPSVI.fMemberType = defaultValue.memberType;\n\t\t\t\t\tattrPSVI.fNormalizedValue = normalized;\n\t\t\t\t\tattrPSVI.fActualValue = defaultValue.actualValue;\n\t\t\t\t\tattrPSVI.fValidationContext = fValidationRoot;\n\t\t\t\t\tattrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n\t\t\t\t\tattrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n\t\t\t\t\tattrPSVI.fSpecified = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} // for\n\t} // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "52"
        },
        "7392bd92a4fbb068fb68a41a3d0b1412cdedfbf3": {
            "type": "Ybodychange",
            "commitMessage": "Fixing bugs 18603: schema default value returned from attribute PSVI\nwasn't correct.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@319186 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "02/04/03 6:15 AM",
            "commitName": "7392bd92a4fbb068fb68a41a3d0b1412cdedfbf3",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "24/03/03 1:10 PM",
            "commitNameOld": "7a54a61a23c3f898d2e9de4ba22861712963f890",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 8.71,
            "commitsBetweenForRepo": 34,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,77 +1,76 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.item(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                     boolean schemaId = defaultValue != null &&\n                                        defaultValue.memberType != null ?\n                                        defaultValue.memberType.isIDType() :\n                                        currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n \n                     \n                 if (fAugPSVI) {\n                     \n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n                     attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n-                    attrPSVI.fSchemaDefault = normalized;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.item(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                    \n                if (fAugPSVI) {\n                    \n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "4"
        },
        "ecb3a007d50064a77832d083a13726949b000a20": {
            "type": "Ybodychange",
            "commitMessage": "Modify PSVI interfaces\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318942 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "14/01/03 12:21 PM",
            "commitName": "ecb3a007d50064a77832d083a13726949b000a20",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "30/12/02 5:55 PM",
            "commitNameOld": "44db052d8fcc26634308593a80400665ad5794fd",
            "commitAuthorOld": "Elena Litani",
            "daysBetweenCommits": 14.77,
            "commitsBetweenForRepo": 31,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,77 +1,77 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n-            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n+            currUse = (XSAttributeUseImpl)attrUses.item(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                     boolean schemaId = defaultValue != null &&\n                                        defaultValue.memberType != null ?\n                                        defaultValue.memberType.isIDType() :\n                                        currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n \n                     \n                 if (fAugPSVI) {\n                     \n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n                     attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n                     attrPSVI.fSchemaDefault = normalized;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.item(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                    \n                if (fAugPSVI) {\n                    \n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fSchemaDefault = normalized;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "95"
        },
        "b25b4597a4c172b405d835abd17a635c716428b5": {
            "type": "Ybodychange",
            "commitMessage": "Fixing bug 14939: the default attribute value was incorrect.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318852 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "28/11/02 10:17 AM",
            "commitName": "b25b4597a4c172b405d835abd17a635c716428b5",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "18/11/02 3:11 PM",
            "commitNameOld": "e51ce2c0e73e2d37d4808f387256722869dad19d",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 9.8,
            "commitsBetweenForRepo": 12,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,76 +1,76 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-                String normalized = (defaultValue!=null)?defaultValue.toString():\"\";\n+                String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                     boolean schemaId = defaultValue != null &&\n                                        defaultValue.memberType != null ?\n                                        defaultValue.memberType.isIDType() :\n                                        currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n \n                 if (fAugPSVI) {\n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n                     attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n                     attrPSVI.fSchemaDefault = normalized;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.stringValue():\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                if (fAugPSVI) {\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fSchemaDefault = normalized;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "1",
            "TangledWMoveandFileRename": "1"
        },
        "e51ce2c0e73e2d37d4808f387256722869dad19d": {
            "type": "Ybodychange",
            "commitMessage": "Make use of the changes made to the data types:\n1. Use canonical representations for validation and PSVI, when required;\n2. Use new equality checking machenism.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318840 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "18/11/02 3:11 PM",
            "commitName": "e51ce2c0e73e2d37d4808f387256722869dad19d",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "08/11/02 11:38 AM",
            "commitNameOld": "692f02297ca0a43ca4ae4c568af141d25bac5210",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 10.15,
            "commitsBetweenForRepo": 19,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,76 +1,76 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-                String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n+                String normalized = (defaultValue!=null)?defaultValue.toString():\"\";\n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                     boolean schemaId = defaultValue != null &&\n                                        defaultValue.memberType != null ?\n                                        defaultValue.memberType.isIDType() :\n                                        currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n \n                 if (fAugPSVI) {\n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n                     attrPSVI.fDeclaration = currDecl;\n                     attrPSVI.fTypeDecl = currDecl.fType;\n                     attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n                     attrPSVI.fSchemaDefault = normalized;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.toString():\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                if (fAugPSVI) {\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fSchemaDefault = normalized;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "9"
        },
        "692f02297ca0a43ca4ae4c568af141d25bac5210": {
            "type": "Ybodychange",
            "commitMessage": "Need to expose type information for default attributes.\nDon't know why the spec didn't ask for the attribute declaration.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318820 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "08/11/02 11:38 AM",
            "commitName": "692f02297ca0a43ca4ae4c568af141d25bac5210",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "25/10/02 9:42 AM",
            "commitNameOld": "37a937f623c26d9fce246bcd0eb9213798c0b231",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 14.12,
            "commitsBetweenForRepo": 20,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,73 +1,76 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                     boolean schemaId = defaultValue != null &&\n                                        defaultValue.memberType != null ?\n                                        defaultValue.memberType.isIDType() :\n                                        currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n \n                 if (fAugPSVI) {\n                     // PSVI: attribute is \"schema\" specified\n                     Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                     AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n+                    attrPSVI.fDeclaration = currDecl;\n+                    attrPSVI.fTypeDecl = currDecl.fType;\n+                    attrPSVI.fMemberType = defaultValue.memberType;\n                     attrPSVI.fNormalizedValue = normalized;\n                     attrPSVI.fSchemaDefault = normalized;\n                     attrPSVI.fValidationContext = fValidationRoot;\n                     attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                     attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                     attrPSVI.fSpecified = true;\n                 }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                if (fAugPSVI) {\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fDeclaration = currDecl;\n                    attrPSVI.fTypeDecl = currDecl.fType;\n                    attrPSVI.fMemberType = defaultValue.memberType;\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fSchemaDefault = normalized;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "1"
        },
        "666a9ddc196896bef002996fbbf5112b56ecdcf1": {
            "type": "Ybodychange",
            "commitMessage": "1. A new feature to indicate whether PSVI augmentation is necessary.\nIt turned out PSVI augmentation is costly. For applications that care about\nperformance but don't need PSVI, this feature can be turned off.\n2. Fixing a PSVI bug: when an attribute is invalid, it's parent should also be\nmarked invalid.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318726 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "18/09/02 2:58 PM",
            "commitName": "666a9ddc196896bef002996fbbf5112b56ecdcf1",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "18/09/02 2:49 PM",
            "commitNameOld": "d25b30225af83c0ff67fecc2da34bfe9c4a9629b",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 0.01,
            "commitsBetweenForRepo": 2,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,71 +1,73 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                 if (attributes instanceof XMLAttributesImpl) {\n                     XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                     boolean schemaId = defaultValue != null &&\n                                        defaultValue.memberType != null ?\n                                        defaultValue.memberType.isIDType() :\n                                        currDecl.fType.isIDType();\n                     attrs.setSchemaId(attrIndex, schemaId);\n                 }\n \n-                // PSVI: attribute is \"schema\" specified\n-                Augmentations augs = attributes.getAugmentations(attrIndex);\n+                if (fAugPSVI) {\n+                    // PSVI: attribute is \"schema\" specified\n+                    Augmentations augs = attributes.getAugmentations(attrIndex);\n \n-                AttributePSVImpl attrPSVI = new AttributePSVImpl();\n-                augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n+                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n+                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n-                attrPSVI.fNormalizedValue = normalized;\n-                attrPSVI.fSchemaDefault = normalized;\n-                attrPSVI.fValidationContext = fValidationRoot;\n-                attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n-                attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n-                attrPSVI.fSpecified = false;\n+                    attrPSVI.fNormalizedValue = normalized;\n+                    attrPSVI.fSchemaDefault = normalized;\n+                    attrPSVI.fValidationContext = fValidationRoot;\n+                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n+                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n+                    attrPSVI.fSpecified = true;\n+                }\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                if (fAugPSVI) {\n                    // PSVI: attribute is \"schema\" specified\n                    Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                    AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                    attrPSVI.fNormalizedValue = normalized;\n                    attrPSVI.fSchemaDefault = normalized;\n                    attrPSVI.fValidationContext = fValidationRoot;\n                    attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                    attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                    attrPSVI.fSpecified = true;\n                }\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "14"
        },
        "20cecb8fa7fe6bc9ad20c645d42075c5f9fef1b6": {
            "type": "Ybodychange",
            "commitMessage": "1. Explicitly set the [schema default] property, since it's separate from the\nattribute declaratoin now.\n2. Update the \"schemaId\" field of XMLAttributesImpl to indicate whether\nan attribute was validated using a schema ID-derived type.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318717 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "16/09/02 2:59 PM",
            "commitName": "20cecb8fa7fe6bc9ad20c645d42075c5f9fef1b6",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "16/09/02 2:36 PM",
            "commitNameOld": "b53332e6e2e64152f2ae6d84c59ce58730255a4d",
            "commitAuthorOld": "Elena Litani",
            "daysBetweenCommits": 0.02,
            "commitsBetweenForRepo": 3,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,69 +1,71 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-\n-                int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n+                String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n+                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n+                if (attributes instanceof XMLAttributesImpl) {\n+                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n+                    boolean schemaId = defaultValue != null &&\n+                                       defaultValue.memberType != null ?\n+                                       defaultValue.memberType.isIDType() :\n+                                       currDecl.fType.isIDType();\n+                    attrs.setSchemaId(attrIndex, schemaId);\n+                }\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n-                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n+                AttributePSVImpl attrPSVI = new AttributePSVImpl();\n+                augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n \n-                // check if PSVIAttribute was added to Augmentations.\n-                // it is possible that we just created new chunck of attributes\n-                // in this case PSVI attribute are not there.\n-                if (attrPSVI != null) {\n-                    attrPSVI.reset();\n-                } else {\n-                    attrPSVI = new AttributePSVImpl();\n-                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n-                }\n-\n-                attrPSVI.fSpecified = false;\n-                // PSVI attribute: validation context\n+                attrPSVI.fNormalizedValue = normalized;\n+                attrPSVI.fSchemaDefault = normalized;\n                 attrPSVI.fValidationContext = fValidationRoot;\n+                attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n+                attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n+                attrPSVI.fSpecified = false;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                String normalized = (defaultValue!=null)?defaultValue.normalizedValue:\"\";\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", normalized);\n                if (attributes instanceof XMLAttributesImpl) {\n                    XMLAttributesImpl attrs = (XMLAttributesImpl)attributes;\n                    boolean schemaId = defaultValue != null &&\n                                       defaultValue.memberType != null ?\n                                       defaultValue.memberType.isIDType() :\n                                       currDecl.fType.isIDType();\n                    attrs.setSchemaId(attrIndex, schemaId);\n                }\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = new AttributePSVImpl();\n                augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n\n                attrPSVI.fNormalizedValue = normalized;\n                attrPSVI.fSchemaDefault = normalized;\n                attrPSVI.fValidationContext = fValidationRoot;\n                attrPSVI.fValidity = AttributePSVI.VALIDITY_VALID;\n                attrPSVI.fValidationAttempted = AttributePSVI.VALIDATION_FULL;\n                attrPSVI.fSpecified = false;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "2"
        },
        "0ca00513ef69c712b32f780d6112f4df373a44f6": {
            "type": "Ybodychange",
            "commitMessage": "Add specialized lists (StringList, ObjectList) to PSVI interfaces. Use these interfaces\nwhen need to return a list of strings or a list of objects.\nAdd implementation for StringList and ObjectList interfaces.\nThe implementation is not optimized: we need to revisit the code and make sure\nwe create list objects only when needed. Also, need to consider whether we can\nuse StringList instead of Vector and string arrays.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318478 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "17/06/02 11:41 AM",
            "commitName": "0ca00513ef69c712b32f780d6112f4df373a44f6",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "08/06/02 4:56 PM",
            "commitNameOld": "fad4e53fc5fe6d68ea4052983a23c55f39480187",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 8.78,
            "commitsBetweenForRepo": 30,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,69 +1,69 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n-        int useCount = attrUses.getListLength();\n+        int useCount = attrUses.getLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n                 attrPSVI.fValidationContext = fValidationRoot;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = fValidationRoot;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "20"
        },
        "6d16ad6967b361d2162b6662305bba9bea7c8ae2": {
            "type": "Ybodychange",
            "commitMessage": "Implemented of normalizeDocument and related set/getNormalizeFeature methods.\nFor the following features setting the state to both true or false is supported:\n\"comments\", \"entities\", \"cdata-sections\", \"split-cdata-sections\", \"discard-default-content\", \"validate\".\nSetting \"datatype-normalization\" to [true] does not have any effect.\n\nImplemented initial support for DOMRevalidation with the following limitations:\n1) Validation can only be performed against XMLSchemaGrammar\n2) XML Schema normalized values as well as default element content will not be exposed\n3) If Entity references are present in the tree their content won't be part of validation process. Same applies for CDATA section nodes.\n4) Attribute value normalization defined by XML 1.0 is not performed (XML Schema requires as precondition to validation that the attribute values will be normalized).\n5) For the documents created from scratch (not using the DOMParser), before calling normalizedDocument() user must set documentURI that represents the baseURI of the document related to which location of schema grammar will resolved.\n6) Performance: the first time user calls normalizeDocument() (with validation turned on) it will be extremely slow since this is the time DOMImplementation will instantiate XMLSchemaValidator. Subsequent calls should be much faster.\n\nIn addition to the listed limitations we need to revisit some of the design issues:\na) Currently it is no longer possible to build DTD only xerces jars, because of dependency of normalizeDocument on XMLSchemaValidator. Explore how we can avoid this dependency (this includes the issue with exposing PSVI in the DOM)\nb) Grammar cashing - we should be able at least to store grammar against which document was revalidated to avoid reparsing the grammar. Multiple issues here.\nc) Implement validators pool - for multi-threaded applications.\netc.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318415 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "23/05/02 5:00 PM",
            "commitName": "6d16ad6967b361d2162b6662305bba9bea7c8ae2",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "21/05/02 2:57 PM",
            "commitNameOld": "cebf2fd2446d2e09a5142e4425ba2640c74beb7e",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 2.09,
            "commitsBetweenForRepo": 6,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,69 +1,69 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n-            System.out.println(\"addDefaultAttributes: \" + element);\n+            System.out.println(\"==>addDefaultAttributes: \" + element);\n         }\n         XSObjectList attrUses = attrGrp.getAttributeUses();\n         int useCount = attrUses.getListLength();\n         XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n                 attrPSVI.fValidationContext = fValidationRoot;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"==>addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getListLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = fValidationRoot;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "72"
        },
        "75e2e681bdd7bc3fd19ab1e3fdda21e09b4ec1ae": {
            "type": "Ybodychange",
            "commitMessage": "Implementing Schema Component Model API:\n- All interfaces in impl.xs.psvi package except XSAnnotation are implemented\n- Using a SymbolHash to store built-in simple types (Hashtable was used)\n- Renamed XSAttributeUse to XSAttributeUseImpl\n- Renamed XSModelGropu to XSModelGroupImpl\n- Removed interfaces XSAtomicSimpleType, XSListSimpleType,\nXSUnionSimpleType, because their methods are included in\nXSSimpleTypeDefinition interface\n- It's still an open issue (please refer to the message\n\"[Schema CM API] How it works with grammar loading\")\nhow XSModel and grammar loading are related. I'll send a separate note\nto the mailing lists to describe how to get XSModel from preparsed grammars.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318397 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "16/05/02 11:25 AM",
            "commitName": "75e2e681bdd7bc3fd19ab1e3fdda21e09b4ec1ae",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "14/05/02 9:04 PM",
            "commitNameOld": "af4e5d86e00e50c1b73f70fcaf8a787aa32d6a15",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 1.6,
            "commitsBetweenForRepo": 4,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,69 +1,69 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n-        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n-        int useCount = (attrUses!=null)? attrUses.length:0;\n-        XSAttributeUse currUse;\n+        XSObjectList attrUses = attrGrp.getAttributeUses();\n+        int useCount = attrUses.getListLength();\n+        XSAttributeUseImpl currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n-            currUse = attrUses[i];\n+            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n-            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n+            if (constType == XSConstants.VC_NONE) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n-            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n+            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n                 int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n                 attrPSVI.fValidationContext = fValidationRoot;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSObjectList attrUses = attrGrp.getAttributeUses();\n        int useCount = attrUses.getListLength();\n        XSAttributeUseImpl currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = (XSAttributeUseImpl)attrUses.getItem(i);\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSConstants.VC_NONE) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSConstants.VC_NONE) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = fValidationRoot;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "270"
        },
        "796400a575745062c61f687a1a33aca5dac3be37": {
            "type": "Ybodychange",
            "commitMessage": "Cleanup for handleStartElement\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318385 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "10/05/02 6:40 AM",
            "commitName": "796400a575745062c61f687a1a33aca5dac3be37",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "02/05/02 8:56 AM",
            "commitNameOld": "7fee3197b7641dde421656c4de18e4c47f155b83",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 7.91,
            "commitsBetweenForRepo": 12,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,72 +1,69 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = (attrUses!=null)? attrUses.length:0;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n-                // needed to update type for DOM Parser to implement getElementById\n-                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n-\n-                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n+                int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n                 attrPSVI.fValidationContext = fValidationRoot;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = (attrUses!=null)? attrUses.length:0;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                int attrIndex = attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = fValidationRoot;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "6"
        },
        "8e28a50b92027b6ebafa72dee1b16d988774b14d": {
            "type": "Ybodychange",
            "commitMessage": "1. Provide PSVI information for the 4 xsi: attributes;\n2. Fixed some bugs in attribute PSVI.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318364 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "26/04/02 2:30 PM",
            "commitName": "8e28a50b92027b6ebafa72dee1b16d988774b14d",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "26/04/02 9:11 AM",
            "commitNameOld": "17509c81b1017be7bb9611645eb9b8f70833afef",
            "commitAuthorOld": "Rahul Srivastava",
            "daysBetweenCommits": 0.22,
            "commitsBetweenForRepo": 5,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,72 +1,72 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = (attrUses!=null)? attrUses.length:0;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n                 // needed to update type for DOM Parser to implement getElementById\n                 String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n \n                 int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n-                attrPSVI.fValidationContext = element.rawname;\n+                attrPSVI.fValidationContext = fValidationRoot;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = (attrUses!=null)? attrUses.length:0;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                // needed to update type for DOM Parser to implement getElementById\n                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n\n                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = fValidationRoot;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "4"
        },
        "b5ab952f0411ccb1f7319bf2723adf5d25ec0931": {
            "type": "Ybodychange",
            "commitMessage": "Tried to optimize XML Schema parsing code:\n1. Implemented XSDeclarationPool.\n2. Modified impl.xs.DOMParser to use NonValidatingConfiguration and specify CoreDocumentImpl\nas DocumentClassName for parsers.DOMParser.\n3. Implemented DOMNodePool that manages the pool of DOM nodes that are\nused for parsing XML Schemas.\n\nI wrote a small program that was parsing and validating 6 files for about 20 times each.\nThe test showed ~7.8% decrease in object creation. The speed of the parser remained the same.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318310 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "03/04/02 3:48 PM",
            "commitName": "b5ab952f0411ccb1f7319bf2723adf5d25ec0931",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "03/04/02 7:09 AM",
            "commitNameOld": "5629a972287499931d55d3aed6597f9f62c24028",
            "commitAuthorOld": "Neil Graham",
            "daysBetweenCommits": 0.36,
            "commitsBetweenForRepo": 3,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,72 +1,72 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n-        int useCount = attrUses.length;\n+        int useCount = (attrUses!=null)? attrUses.length:0;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n                 // needed to update type for DOM Parser to implement getElementById\n                 String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n \n                 int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n                 attrPSVI.fValidationContext = element.rawname;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = (attrUses!=null)? attrUses.length:0;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                // needed to update type for DOM Parser to implement getElementById\n                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n\n                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = element.rawname;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "70"
        },
        "f17905e8fb81376d5e118eed13fcab5b2897f20f": {
            "type": "Ybodychange",
            "commitMessage": "Added new XML Schema features:\na) validation/schema/normalized-value -- allows to expose XML Schema normalized values via DOM/SAX\nb) validation/schema/element-default  -- sends characters() calls for schema element default values.\n\nBy default, both feature are set to true. The features are no-op if validation occurs against DTD.\nIf XML Schema validation is turned on, characters() include 2 values: XMLString always includes original value, Augmentations includes ElementPSVI for which normalizedSchemaValue property is set (if in element content).\nXML Schema default attribute are always included in the pipeline with name, namespace, specified and value properties. Additional information, such as schema_specified is stored in Augmentations.\n\nFor all simpleTypes, but union, normalization occurs for each chunk of data we receive.\nFor union types, we can't normalize data until we receive all of it. Thus, for union types we do the following:\n(1) sending of characters back to application is delayed till endElement()\n(2) if characters() include some augmentations, XMLSchemaValidator will omit character() call with augmentations and empty string as a value. At SAX/DOM level those calls will be ignored.\n(3) the normalized value for union datatype is send before endElement() call.\n\nTo do:\n-- update docs\n-- verify what should be behavior if entityref or cdata section\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@318145 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "27/01/02 4:35 PM",
            "commitName": "f17905e8fb81376d5e118eed13fcab5b2897f20f",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "24/01/02 12:52 PM",
            "commitNameOld": "0c89615b0bdfe565e769952ce9d81b62b7cd076a",
            "commitAuthorOld": "Neil Graham",
            "daysBetweenCommits": 3.16,
            "commitsBetweenForRepo": 11,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,72 +1,72 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n             // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n \n                 // needed to update type for DOM Parser to implement getElementById\n                 String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n \n                 int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n-                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n+                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n                 if (attrPSVI != null) {\n                     attrPSVI.reset();\n                 } else {\n                     attrPSVI = new AttributePSVImpl();\n-                    augs.putItem(ATTR_PSVI, attrPSVI);\n+                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                 }\n \n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n                 attrPSVI.fValidationContext = element.rawname;\n             }\n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                // needed to update type for DOM Parser to implement getElementById\n                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n\n                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(Constants.ATTRIBUTE_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(Constants.ATTRIBUTE_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = element.rawname;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "32"
        },
        "8956d0e37f3362fce53d0baf75ae0bfdc7a30ae4": {
            "type": "Ybodychange",
            "commitMessage": "The \"validation root\" defined in schema spec is not always the docment root.\nNow we take this into account, and change the following accordingly:\n1. id/idref checking: they should be done with a validation root sub-tree,\ninstead of within an instance document.\n2. element psvi output: the validation context property should be the validation root.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317974 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "06/12/01 2:54 PM",
            "commitName": "8956d0e37f3362fce53d0baf75ae0bfdc7a30ae4",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "06/12/01 1:49 PM",
            "commitNameOld": "d24395408f0109ac86e12cda36653b49564205fd",
            "commitAuthorOld": "Neil Graham",
            "daysBetweenCommits": 0.05,
            "commitsBetweenForRepo": 2,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,72 +1,72 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n \n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n-            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose \n-            // {required} is true matches one of the attribute information items in the element \n+            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n+            // {required} is true matches one of the attribute information items in the element\n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-                \n-                // needed to update type for DOM Parser to implement getElementById                 \n+\n+                // needed to update type for DOM Parser to implement getElementById\n                 String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n-                \n+\n                 int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n-                \n+\n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n \n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n \n                 // check if PSVIAttribute was added to Augmentations.\n                 // it is possible that we just created new chunck of attributes\n                 // in this case PSVI attribute are not there.\n-                 if (attrPSVI == null) {\n+                if (attrPSVI != null) {\n+                    attrPSVI.reset();\n+                } else {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(ATTR_PSVI, attrPSVI);\n-                }  \n-                \n+                }\n+\n                 attrPSVI.fSpecified = false;\n                 // PSVI attribute: validation context\n-                attrPSVI.fValidationContext = element.toString();\n-               \n+                attrPSVI.fValidationContext = element.rawname;\n             }\n \n-\n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose\n            // {required} is true matches one of the attribute information items in the element\n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n\n                // needed to update type for DOM Parser to implement getElementById\n                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n\n                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n\n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                if (attrPSVI != null) {\n                    attrPSVI.reset();\n                } else {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(ATTR_PSVI, attrPSVI);\n                }\n\n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = element.rawname;\n            }\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "5"
        },
        "3a5616841fafc6baf1fc02bf61b3afb56f07ca64": {
            "type": "Ybodychange",
            "commitMessage": "Finish up support for AttributePSVI.\ngetElementById() should now work for XML Schemas\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317971 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "06/12/01 1:00 PM",
            "commitName": "3a5616841fafc6baf1fc02bf61b3afb56f07ca64",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "05/12/01 2:59 PM",
            "commitNameOld": "4e1e19ced55a817426c001c80c45a318b4be4e04",
            "commitAuthorOld": "Elena Litani",
            "daysBetweenCommits": 0.92,
            "commitsBetweenForRepo": 1,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,64 +1,72 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n+\n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose \n             // {required} is true matches one of the attribute information items in the element \n             // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 \n-                // REVISIT: implement getElementById for DOM using schemas\n+                // needed to update type for DOM Parser to implement getElementById                 \n                 String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n+                \n                 int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n                 \n                 // PSVI: attribute is \"schema\" specified\n                 Augmentations augs = attributes.getAugmentations(attrIndex);\n+\n                 AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n-                // see REVISIT at processAttributes()\n-                /* if (attrPSVI == null) {\n+\n+                // check if PSVIAttribute was added to Augmentations.\n+                // it is possible that we just created new chunck of attributes\n+                // in this case PSVI attribute are not there.\n+                 if (attrPSVI == null) {\n                     attrPSVI = new AttributePSVImpl();\n                     augs.putItem(ATTR_PSVI, attrPSVI);\n                 }  \n-                */\n-                attrPSVI.fSpecified = true;\n+                \n+                attrPSVI.fSpecified = false;\n+                // PSVI attribute: validation context\n+                attrPSVI.fValidationContext = element.toString();\n                \n             }\n \n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose \n            // {required} is true matches one of the attribute information items in the element \n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                \n                // needed to update type for DOM Parser to implement getElementById                 \n                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n                \n                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n                \n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n\n                // check if PSVIAttribute was added to Augmentations.\n                // it is possible that we just created new chunck of attributes\n                // in this case PSVI attribute are not there.\n                 if (attrPSVI == null) {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(ATTR_PSVI, attrPSVI);\n                }  \n                \n                attrPSVI.fSpecified = false;\n                // PSVI attribute: validation context\n                attrPSVI.fValidationContext = element.toString();\n               \n            }\n\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "6"
        },
        "4e1e19ced55a817426c001c80c45a318b4be4e04": {
            "type": "Ybodychange",
            "commitMessage": "Add partial attribute PSVI information. Modified XNI to support it.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317970 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "05/12/01 2:59 PM",
            "commitName": "4e1e19ced55a817426c001c80c45a318b4be4e04",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "05/12/01 10:07 AM",
            "commitNameOld": "e1067d16c3b4825dc53e1703e5a65c400bf7c30b",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 0.2,
            "commitsBetweenForRepo": 4,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,51 +1,64 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n-            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n+            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose \n+            // {required} is true matches one of the attribute information items in the element \n+            // information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-                // REVISIT: fType on decl must be simpleType decl, using which we can find\n-                // out the type. In the mean time, we must at least set CDATA,\n-                // and we really need to know what attributes are of type ID:\n-                // DOM requires some special handling for those ones.\n-                attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n+                \n+                // REVISIT: implement getElementById for DOM using schemas\n+                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n+                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n+                \n+                // PSVI: attribute is \"schema\" specified\n+                Augmentations augs = attributes.getAugmentations(attrIndex);\n+                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n+                // see REVISIT at processAttributes()\n+                /* if (attrPSVI == null) {\n+                    attrPSVI = new AttributePSVImpl();\n+                    augs.putItem(ATTR_PSVI, attrPSVI);\n+                }  \n+                */\n+                attrPSVI.fSpecified = true;\n+               \n             }\n \n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose \n            // {required} is true matches one of the attribute information items in the element \n            // information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                \n                // REVISIT: implement getElementById for DOM using schemas\n                String type = (currDecl.fType.isIDType())?\"ID\":\"CDATA\";\n                int attrIndex = attributes.addAttribute(attName, type, (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n                \n                // PSVI: attribute is \"schema\" specified\n                Augmentations augs = attributes.getAugmentations(attrIndex);\n                AttributePSVImpl attrPSVI = (AttributePSVImpl)augs.getItem(ATTR_PSVI);\n                // see REVISIT at processAttributes()\n                /* if (attrPSVI == null) {\n                    attrPSVI = new AttributePSVImpl();\n                    augs.putItem(ATTR_PSVI, attrPSVI);\n                }  \n                */\n                attrPSVI.fSpecified = true;\n               \n            }\n\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "18"
        },
        "71823bb76fbbe51476f8c4f76984133133ae289e": {
            "type": "Ybodychange",
            "commitMessage": "Switching to the new simple type iimplementation. This enable us to get more\ninformation from simple types, which is essential to PSVI support.\n1. Modified xs package to use the new simple type interfaces.\n2. Fixed bugs in the new simple type implementation.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317956 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "30/11/01 11:29 AM",
            "commitName": "71823bb76fbbe51476f8c4f76984133133ae289e",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "28/11/01 11:26 AM",
            "commitNameOld": "a21ae11d500c4ce5da4c0571a03088d08fa907ea",
            "commitAuthorOld": "Shudi Gao",
            "daysBetweenCommits": 2.0,
            "commitsBetweenForRepo": 5,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,51 +1,51 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n-        Object defaultValue;\n+        ValidatedInfo defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 // REVISIT: fType on decl must be simpleType decl, using which we can find\n                 // out the type. In the mean time, we must at least set CDATA,\n                 // and we really need to know what attributes are of type ID:\n                 // DOM requires some special handling for those ones.\n-                attributes.addAttribute(attName, \"CDATA\", (defaultValue !=null)?defaultValue.toString():\"\");\n+                attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n             }\n \n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        ValidatedInfo defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                // REVISIT: fType on decl must be simpleType decl, using which we can find\n                // out the type. In the mean time, we must at least set CDATA,\n                // and we really need to know what attributes are of type ID:\n                // DOM requires some special handling for those ones.\n                attributes.addAttribute(attName, \"CDATA\", (defaultValue!=null)?defaultValue.normalizedValue:\"\");\n            }\n\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "70"
        },
        "e8a80f3c5d0c6e2786e6e699b2aa47d125a9287a": {
            "type": "Ybodychange",
            "commitMessage": "Implemented element by id registration required for getElementById() method.\nThis will work only for DTDs (we can't at the moment retrieve ID type for schema attributes)\nBinded namespace attributes defined in XML-Infoset to  http://www.w3.org/2000/xmlns/\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317881 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "06/11/01 6:24 AM",
            "commitName": "e8a80f3c5d0c6e2786e6e699b2aa47d125a9287a",
            "commitAuthor": "Elena Litani",
            "commitDateOld": "01/11/01 8:48 PM",
            "commitNameOld": "2b0f349f0c561d6a25f69359c74a9154964208fb",
            "commitAuthorOld": "Andy Clark",
            "daysBetweenCommits": 4.4,
            "commitsBetweenForRepo": 16,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,48 +1,51 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         Object defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                 constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n-                //REVISIT: what's the proper attrType?\n-                attributes.addAttribute(attName, null, (defaultValue !=null)?defaultValue.toString():\"\");\n+                // REVISIT: fType on decl must be simpleType decl, using which we can find\n+                // out the type. In the mean time, we must at least set CDATA, \n+                // and we really need to know what attributes are of type ID:\n+                // DOM requires some special handling for those ones.\n+                attributes.addAttribute(attName, \"CDATA\", (defaultValue !=null)?defaultValue.toString():\"\");\n             }\n \n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        Object defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                // REVISIT: fType on decl must be simpleType decl, using which we can find\n                // out the type. In the mean time, we must at least set CDATA, \n                // and we really need to know what attributes are of type ID:\n                // DOM requires some special handling for those ones.\n                attributes.addAttribute(attName, \"CDATA\", (defaultValue !=null)?defaultValue.toString():\"\");\n            }\n\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "3"
        },
        "c6e91d6992e5101de286a0755a9105829515900a": {
            "type": "Ybodychange",
            "commitMessage": "1. reorganize method calls, so that code for schema validation and code for forwarding xni events are separated.\n2. for default/fixed values, send characters() event between startElement and endElement. The behavior before was a bug.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317851 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "01/11/01 12:05 PM",
            "commitName": "c6e91d6992e5101de286a0755a9105829515900a",
            "commitAuthor": "Shudi Gao",
            "commitDateOld": "26/10/01 9:58 AM",
            "commitNameOld": "1070d2d64c0e82e786e303c4c568f84d462aef06",
            "commitAuthorOld": "Lisa Martin",
            "daysBetweenCommits": 6.13,
            "commitsBetweenForRepo": 11,
            "commitsBetweenForFile": 1,
            "diff": "@@ -1,48 +1,48 @@\n     void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n         // Check after all specified attrs are scanned\n         // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n         // REVISIT: should we check prohibited attributes?\n         // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n         // (3) add default attrs (FIXED and NOT_FIXED)\n         //\n         if (DEBUG) {\n             System.out.println(\"addDefaultAttributes: \" + element);\n         }\n         XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n         int useCount = attrUses.length;\n         XSAttributeUse currUse;\n         XSAttributeDecl currDecl;\n         short constType;\n         Object defaultValue;\n         boolean isSpecified;\n         QName attName;\n         // for each attribute use\n         for (int i = 0; i < useCount; i++) {\n             currUse = attrUses[i];\n             currDecl = currUse.fAttrDecl;\n             // get value constraint\n             constType = currUse.fConstraintType;\n             defaultValue = currUse.fDefault;\n             if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n-                constType = currDecl.fConstraintType;\n+                constType = currDecl.getConstraintType();\n                 defaultValue = currDecl.fDefault;\n             }\n             // whether this attribute is specified\n             isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n \n             // Element Locally Valid (Complex Type)\n             // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n             if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                 if (!isSpecified)\n                     reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n             }\n             // if the attribute is not specified, then apply the value constraint\n             if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                 attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                 //REVISIT: what's the proper attrType?\n                 attributes.addAttribute(attName, null, (defaultValue !=null)?defaultValue.toString():\"\");\n             }\n \n \n         } // for\n     } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        Object defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.getConstraintType();\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                //REVISIT: what's the proper attrType?\n                attributes.addAttribute(attName, null, (defaultValue !=null)?defaultValue.toString():\"\");\n            }\n\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "extendedDetails": {},
            "BugCommit": "0",
            "TangledWMoveandFileRename": "19"
        },
        "22c0e12e4b704d038f0b290865301ebf56f40455": {
            "type": "Yintroduced",
            "commitMessage": "Package reorganization to include alpha XML Schema support.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xerces/java/trunk@317824 13f79535-47bb-0310-9956-ffa450edef68\n",
            "commitDate": "25/10/01 1:36 PM",
            "commitName": "22c0e12e4b704d038f0b290865301ebf56f40455",
            "commitAuthor": "Elena Litani",
            "diff": "@@ -0,0 +1,48 @@\n+    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n+        // Check after all specified attrs are scanned\n+        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n+        // REVISIT: should we check prohibited attributes?\n+        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n+        // (3) add default attrs (FIXED and NOT_FIXED)\n+        //\n+        if (DEBUG) {\n+            System.out.println(\"addDefaultAttributes: \" + element);\n+        }\n+        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n+        int useCount = attrUses.length;\n+        XSAttributeUse currUse;\n+        XSAttributeDecl currDecl;\n+        short constType;\n+        Object defaultValue;\n+        boolean isSpecified;\n+        QName attName;\n+        // for each attribute use\n+        for (int i = 0; i < useCount; i++) {\n+            currUse = attrUses[i];\n+            currDecl = currUse.fAttrDecl;\n+            // get value constraint\n+            constType = currUse.fConstraintType;\n+            defaultValue = currUse.fDefault;\n+            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n+                constType = currDecl.fConstraintType;\n+                defaultValue = currDecl.fDefault;\n+            }\n+            // whether this attribute is specified\n+            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n+\n+            // Element Locally Valid (Complex Type)\n+            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n+            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n+                if (!isSpecified)\n+                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n+            }\n+            // if the attribute is not specified, then apply the value constraint\n+            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n+                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n+                //REVISIT: what's the proper attrType?\n+                attributes.addAttribute(attName, null, (defaultValue !=null)?defaultValue.toString():\"\");\n+            }\n+\n+\n+        } // for\n+    } // addDefaultAttributes\n\\ No newline at end of file\n",
            "actualSource": "    void addDefaultAttributes(QName element, XMLAttributes attributes, XSAttributeGroupDecl attrGrp) {\n        // Check after all specified attrs are scanned\n        // (1) report error for REQUIRED attrs that are missing (V_TAGc)\n        // REVISIT: should we check prohibited attributes?\n        // (2) report error for PROHIBITED attrs that are present (V_TAGc)\n        // (3) add default attrs (FIXED and NOT_FIXED)\n        //\n        if (DEBUG) {\n            System.out.println(\"addDefaultAttributes: \" + element);\n        }\n        XSAttributeUse attrUses[] = attrGrp.getAttributeUses();\n        int useCount = attrUses.length;\n        XSAttributeUse currUse;\n        XSAttributeDecl currDecl;\n        short constType;\n        Object defaultValue;\n        boolean isSpecified;\n        QName attName;\n        // for each attribute use\n        for (int i = 0; i < useCount; i++) {\n            currUse = attrUses[i];\n            currDecl = currUse.fAttrDecl;\n            // get value constraint\n            constType = currUse.fConstraintType;\n            defaultValue = currUse.fDefault;\n            if (constType == XSAttributeDecl.NO_CONSTRAINT) {\n                constType = currDecl.fConstraintType;\n                defaultValue = currDecl.fDefault;\n            }\n            // whether this attribute is specified\n            isSpecified = attributes.getValue(currDecl.fTargetNamespace, currDecl.fName) != null;\n\n            // Element Locally Valid (Complex Type)\n            // 4 The {attribute declaration} of each attribute use in the {attribute uses} whose {required} is true matches one of the attribute information items in the element information item's [attributes] as per clause 3.1 above.\n            if (currUse.fUse == SchemaSymbols.USE_REQUIRED) {\n                if (!isSpecified)\n                    reportSchemaError(\"cvc-complex-type.4\", new Object[]{element.rawname, currDecl.fName});\n            }\n            // if the attribute is not specified, then apply the value constraint\n            if (!isSpecified && constType != XSAttributeDecl.NO_CONSTRAINT) {\n                attName = new QName(null, currDecl.fName, currDecl.fName, currDecl.fTargetNamespace);\n                //REVISIT: what's the proper attrType?\n                attributes.addAttribute(attName, null, (defaultValue !=null)?defaultValue.toString():\"\");\n            }\n\n\n        } // for\n    } // addDefaultAttributes",
            "path": "src/org/apache/xerces/impl/xs/XMLSchemaValidator.java",
            "BugCommit": "0",
            "TangledWMoveandFileRename": "0"
        }
    },
    "file": "7444.json"
}